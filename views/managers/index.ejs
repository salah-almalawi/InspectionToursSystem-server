<%- include('./partials/header.ejs') %>
<h1>إدارة المديرين</h1>

<section class="add-manager">
  <h2>إضافة مدير</h2>
  <form action="/managers" method="post">
    <label>الاسم:</label>
    <input type="text" name="name" required>
    <label>الرتبة:</label>
    <input type="number" name="rank" min="1" max="16" required>
    <label>القسم:</label>
    <input type="text" name="department" required>
    <button type="submit">إضافة</button>
  </form>
</section>

<section class="update-manager">
  <h2>تحديث مدير</h2>
  <form action="/managers/update" method="post">
    <label>المعرف:</label>
    <input type="text" name="id" required>
    <label>الاسم:</label>
    <input type="text" name="name">
    <label>الرتبة:</label>
    <input type="number" name="rank" min="1" max="16">
    <label>القسم:</label>
    <input type="text" name="department">
    <button type="submit">تحديث</button>
  </form>
</section>

<section class="list-managers">
  <h2>قائمة المديرين</h2>
  <table>
    <thead>
      <tr>
        <th>الاسم</th>
        <th>الرتبة</th>
        <th>القسم</th>
        <th>حذف</th>
      </tr>
    </thead>
    <tbody>
      <% managers.forEach(function(m) { %>
      <tr>
        <td><%= m.name %></td>
        <td><%= m.rank %></td>
        <td><%= m.department %></td>
        <td>
          <form action="/managers/<%= m._id %>/delete" method="post">
            <button type="submit">حذف</button>
          </form>
        </td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</section>

<section class="show-manager">
  <h2>استعراض مدير</h2>
  <form method="get" action="/managers">
    <input type="text" name="id" placeholder="معرف المدير" required>
    <button type="submit">عرض</button>
  </form>
  <% if (summary) { %>
  <div class="manager-details">
    <h3>بيانات المدير</h3>
    <p>الاسم: <%= summary.manager.name %></p>
    <p>الرتبة: <%= summary.manager.rank %></p>
    <p>القسم: <%= summary.manager.department %></p>
    <h4>آخر الجولات</h4>
    <ul>
      <% summary.manager.lastRounds.forEach(function(r) { %>
      <li><%= r.location %> - <%= r.day %></li>
      <% }) %>
    </ul>
  </div>
  <% } %>
</section>

<%- include('./partials/footer.ejs') %>
